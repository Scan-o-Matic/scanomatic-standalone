[tox]
envlist = py39,mypy,lint
skipsdist = true

[testenv]
deps =
    -rrequirements.txt
    mock
    pytest
    pytest-cov
    pytest-docker
    pytest-flask
    selenium
setenv =
    SCANOMATIC_DATA = {toxinidir}/data/
    PATH=$PATH:/usr/lib/chromium-browser/
    LD_LIBRARY_PATH=/usr/lib/chromium-browser
whitelist_externals =
    chromedriver
passenv =
    DISPLAY
commands =
    pytest \
        --cov scanomatic --cov scripts --cov-report xml \
        --junitxml result.xml --ignore dev \
        {posargs}

[testenv:mypy]
basepython = python3.9
sitepackages = False
deps =
    -rrequirements.txt
    types-freezegun
    mypy
commands =
    mypy --check-untyped-defs --warn-unused-ignores --no-incremental \
    slipstream tests

[testenv:lint]
deps =
    flake8
commands =
    flake8

[flake8]
max_line_length = 80
extend_exclude = node_modules
